
<section class="section profile">
  <div class="row">
    <div class="col-xl-4">

      <div class="card">
        <div class="card-body profile-card pt-4 d-flex flex-column align-items-center">

          <h2>{$edit_tool.NameTool}</h2>
          <h3>{$edit_tool.SerialNumber}</h3>
          <div class="social-links mt-2 tool-photo-thumbs d-flex flex-column gap-2" data-tool-photos="list">
          {if $edit_tool.img_path}
            {foreach $edit_tool.img_path as $photo}
              <img src="{$photo}" alt="Tool photo" class="rounded-circle" style="width: 96px; height: 96px; object-fit: cover;">
            {/foreach}
          {else}
            <span class="text-muted small">Фото инструмента пока нет</span>
          {/if}
          <!--<a href="#" class="twitter"><i class="bi bi-twitter"></i></a>
            <a href="#" class="facebook"><i class="bi bi-facebook"></i></a>
            <a href="#" class="instagram"><i class="bi bi-instagram"></i></a>
            <a href="#" class="linkedin"><i class="bi bi-linkedin"></i></a>-->
          </div>
        </div>
      </div>

    </div>

    <div class="col-xl-8">

      <div class="card">
        <div class="card-body pt-3">

          <!-- ОДИН общий form на все вкладки -->
          <form id="tool-profile-form">
            <input type="hidden" name="tool_id" id="tool_id" value="{$edit_tool.id|default:''}">
            <!-- Bordered Tabs -->
            <ul class="nav nav-tabs nav-tabs-bordered">
              <li class="nav-item">
                <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#profile-overview" type="button">Overview</button>
              </li>

              <li class="nav-item">
                <button class="nav-link" data-bs-toggle="tab" data-bs-target="#profile-edit" type="button">Edit Tool</button>
              </li>

              <li class="nav-item">
                <button class="nav-link" data-bs-toggle="tab" data-bs-target="#profile-settings" type="button">Remark</button>
              </li>
<!--
              <li class="nav-item">
                <button class="nav-link" data-bs-toggle="tab" data-bs-target="#profile-change-password" type="button">Change Password</button>
              </li>
-->
            </ul>

            <div class="tab-content pt-2">

              <!-- OVERVIEW -->
              <div class="tab-pane fade show active profile-overview" id="profile-overview">
                <h5 class="card-title">About</h5>
                <p class="small fst-italic">{$edit_user.settings.about}</p>

                <h5 class="card-title">Tool Details</h5>

                <div class="row">
                  <div class="col-lg-3 col-md-4 label ">Name Tool</div>
                  <div class="col-lg-9 col-md-8">{$edit_tool.NameTool}</div>
                </div>

                <div class="row">
                  <div class="col-lg-3 col-md-4 label">Serial number</div>
                  <div class="col-lg-9 col-md-8">{$edit_tool.SerialNumber}</div>
                </div>

                <div class="row">
                  <div class="col-lg-3 col-md-4 label">Waranty / days</div>
                  <div class="col-lg-9 col-md-8">{$edit_tool.WarantyDays}</div>
                </div>

                <div class="row">
                  <div class="col-lg-3 col-md-4 label">Price buy</div>
                  <div class="col-lg-9 col-md-8">{$edit_tool.PriceBuy}</div>
                </div>

                <div class="row">
                  <div class="col-lg-3 col-md-4 label">Date buy</div>
                  <div class="col-lg-9 col-md-8">{$edit_tool.DateBuy}</div>
                </div>

                <div class="row">
                  <div class="col-lg-3 col-md-4 label">Add in system date</div>
                  <div class="col-lg-9 col-md-8">{$edit_tool.AddInSystem}</div>
                </div>

                <div class="row">
                  <div class="col-lg-3 col-md-4 label">Resource / days</div>
                  <div class="col-lg-9 col-md-8">{$edit_tool.ResourceDays}</div>
                </div>

                <div class="row">
                  <div class="col-lg-3 col-md-4 label">Resurce end date</div>
                  <div class="col-lg-9 col-md-8">{$edit_tool.ResourceEndDate}</div>
                </div>

                <div class="row">
                  <div class="col-lg-3 col-md-4 label">QR Code tool</div>
                  <div class="col-lg-9 col-md-8 d-flex gap-2 flex-wrap">
                    {if $edit_tool.qr_codes}
                      {foreach $edit_tool.qr_codes as $qr}
                        <div class="d-flex flex-column align-items-center">
                          <img src="{$qr.path}" alt="QR {$qr.size}" class="" style="width:90px; height:90px; object-fit:cover;">
                          <small class="text-muted">{$qr.size}</small>
                        </div>
                      {/foreach}
                    {else}
                      <span class="text-muted">QR code will be generated after saving</span>
                    {/if}
                  </div>
                </div>
              </div>

                <div class="row">
                  <div class="col-lg-3 col-md-4 label">
                  <!--<label for="Email" class="col-md-4 col-lg-3 col-form-label">Статус</label>-->
                  </div>
                </div>


              <!-- EDIT PROFILE -->
              <div class="tab-pane fade profile-edit pt-3" id="profile-edit">

                <div class="row mb-3">
                  <label for="profileImage" class="col-md-4 col-lg-3 col-form-label">Tool Image</label>
                  <div class="col-md-8 col-lg-9">
                    <!--<img src="assets/img/profile-img.jpg" alt="Profile">-->
                    <div class="pt-2" id="uploadPhoto" {if !$edit_tool.id} style="display:none"{/if}>
                      <a href="#" class="btn btn-primary btn-sm js-core-link" data-core-action="upload_tool_photo" data-tool-id="{$edit_tool.id}" title="Upload new profile image"><i class="bi bi-upload"></i></a>
                      <a href="#" class="btn btn-danger btn-sm disabled" title="Remove my profile image"><i class="bi bi-trash"></i></a>
                      <input type="file" accept="image/*" capture="environment" id="tool-photo-input" class="d-none">
                    </div>
                  </div>
                </div>

                <div class="row mb-3">
                  <label for="fullName" class="col-md-4 col-lg-3 col-form-label">Name Tool</label>
                  <div class="col-md-8 col-lg-9">
                    <input name="NameTool" type="text" class="form-control" id="NameTool"
                           value="{$edit_tool.NameTool}">
                  </div>
                </div>

                <div class="row mb-3">
                </div>

                <div class="row mb-3">
                  <label for="company" class="col-md-4 col-lg-3 col-form-label">Serial number</label>
                  <div class="col-md-8 col-lg-9">
                    <input name="SerialNumber" type="text" class="form-control" id="SerialNumber"
                           value="{$edit_tool.SerialNumber}">
                  </div>
                </div>

                <div class="row mb-3">
                  <label for="Job" class="col-md-4 col-lg-3 col-form-label">Waranty / days</label>
                  <div class="col-md-8 col-lg-9">
                    <input name="WarantyDays" type="number" class="form-control" id="WarantyDays"
                           value="{$edit_tool.WarantyDays}">
                  </div>
                </div>

                <div class="row mb-3">
                  <label for="Country" class="col-md-4 col-lg-3 col-form-label">Price buy</label>
                  <div class="col-md-8 col-lg-9">
                    <input name="PriceBuy" type="text" class="form-control" id="PriceBuy"
                           value="{$edit_tool.PriceBuy}">
                  </div>
                </div>

                <div class="row mb-3">
                  <label for="Address" class="col-md-4 col-lg-3 col-form-label">Date buy</label>
                  <div class="col-md-8 col-lg-9">
                    <input name="DateBuy" type="date" class="form-control" id="DateBuy"
                           value="{$edit_tool.DateBuy}">
                  </div>
                </div>

                <div class="row mb-3">
                  <label for="Phone" class="col-md-4 col-lg-3 col-form-label">Add in system</label>
                  <div class="col-md-8 col-lg-9">
                    <input name="AddInSystem" type="date" class="form-control" id="AddInSystem"
                           value="{$edit_tool.AddInSystem}" readonly>
                  </div>
                </div>

                <div class="row mb-3">
                  <label for="" class="col-md-4 col-lg-3 col-form-label">Resource / days</label>
                  <div class="col-md-8 col-lg-9">
                    <input name="ResourceDays" type="number" class="form-control" id="ResourceDays"
                           value="{$edit_tool.ResourceDays}">
                  </div>
                </div>


                <div class="row mb-3">
                  <label for="Email" class="col-md-4 col-lg-3 col-form-label">Resource end date</label>
                  <div class="col-md-8 col-lg-9">
                    <input name="ResourceEndDate" type="date" class="form-control" id="ResourceEndDate"
                           value="{$edit_tool.ResourceEndDate}" readonly>
                  </div>
                </div>

                <div class="row mb-3">
                  <label for="Email" class="col-md-4 col-lg-3 col-form-label">Статус</label>
                  <div class="col-md-8 col-lg-9">
                  <div class="form-check form-switch">
                      <input class="form-check-input" type="checkbox" name="status" id="statusCheck"
                      {if $edit_tool.status == 'active' } checked="true" {/if}>
                      <label class="form-check-label" for="statusCheck">Если активный инструмент он доступен для работы</label>
                  </div>
                  </div>
                </div>

                <div class="form-check">
                  <input class="form-check-input" type="checkbox" id="delete" name="delete">
                  <label class="form-check-label" for="securityNotify">
                    Удалить Инструмент
                  </label>
                </div>


                <div class="text-center">
                  <button type="button"
                          class="btn btn-primary js-core-link"
                          data-core-action="save_tool">Save Changes</button>
                </div>
              </div>

              <!-- SETTINGS -->
              <div class="tab-pane fade pt-3" id="profile-settings">

                <div class="row mb-3">
                      <label class="col-sm-2 col-form-label">Привязать к пользователю</label>
                      <div class="col-sm-10">
                        <select class="form-select" name="role" aria-label="Default select example">
                          <option value="0" selected="">Выбрать один из</option>
                          {foreach $roles as $r}
                            <option value="{$r.code}" {if $edit_user.role|default:'' == $r.code}selected{/if}>{$r.code}</option>
                          {/foreach}
                        </select>
                      </div>
                    </div>
                  <div class="row mt-3">
                  <label for="about" class="col-md-4 col-lg-3 col-form-label">Notes</label>
                  <div class="col-md-8 col-lg-9">
                    <textarea name="notes" class="form-control" id="about" style="height: 100px">{$edit_tool.notes}</textarea>
                 </div>
                 </div>
                                 <!--
                  <label class="col-md-4 col-lg-3 col-form-label">Email Notifications</label>
                  <div class="col-md-8 col-lg-9">
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" name="changesMade" id="changesMade" checked>
                      <label class="form-check-label" for="changesMade">
                        Changes made to your account
                      </label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" name="newProducts" id="newProducts" checked>
                      <label class="form-check-label" for="newProducts">
                        Information on new products and services
                      </label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" name="proOffers" id="proOffers">
                      <label class="form-check-label" for="proOffers">
                        Marketing and promo offers
                      </label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" name="securityNotify" id="securityNotify" checked disabled>
                      <label class="form-check-label" for="securityNotify">
                        Security alerts
                      </label>
                    </div>-->



                    <div class="row mt-3">
                       <div class="col-lg-3 col-md-4 label">История изминений</div>
                          <div class="col-lg-9 col-md-8">
                          </div>
                       </div>
                  </div>

<!--                  <div class="text-center">
                  <button type="button" class="btn btn-primary js-core-link" data-core-action="save_user">Save Changes</button>
                  </div>
-->
                </div>

              </div>
              </div>

              <!-- CHANGE PASSWORD -->
              <div class="tab-pane fade pt-3" id="profile-change-password">
                <div class="row mb-3">
                  <label for="newPassword" class="col-md-4 col-lg-3 col-form-label">New Password</label>
                  <div class="col-md-8 col-lg-9">
                    <input name="newpassword" type="password" class="form-control" id="newPassword">
                  </div>
                </div>

                <div class="text-center">
                  <button type="button"  class="btn btn-primary js-core-link"  data-core-action="save_user">Change Password</button>
                </div>
              </div>

            </div><!-- /.tab-content -->
          </form><!-- /#user-profile-form -->

        </div>
      </div>

    </div>
  </div>
</section>


